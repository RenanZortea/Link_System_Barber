{"version":3,"file":"react-smooth-scroll-hook.cjs.development.js","sources":["../src/utils.ts","../src/useSmoothScroll.tsx","../src/useScrollWatch.ts"],"sourcesContent":["export enum Direction {\n  X = 'x',\n  Y = 'y',\n}\nexport type DirectionType = Direction | 'x' | 'y';\nexport type AttrMapType = {\n  scrollLeftTop: 'scrollLeft' | 'scrollTop';\n  scrollWidthHeight: 'scrollWidth' | 'scrollHeight';\n  clientWidthHeight: 'clientWidth' | 'clientHeight';\n  offsetLeftTop: 'offsetLeft' | 'offsetTop';\n  offsetWidthHeight: 'offsetWidth' | 'offsetHeight';\n  leftTop: 'top' | 'left';\n};\nexport const getAttrMap = (direction: DirectionType) => {\n  return {\n    leftTop: Direction.X === direction ? 'left' : 'top',\n    offsetLeftTop: Direction.X === direction ? 'offsetLeft' : 'offsetTop',\n    offsetWidthHeight:\n      Direction.X === direction ? 'offsetWidth' : 'offsetHeight',\n    scrollLeftTop: Direction.X === direction ? 'scrollLeft' : 'scrollTop',\n    scrollWidthHeight:\n      Direction.X === direction ? 'scrollWidth' : 'scrollHeight',\n    clientWidthHeight:\n      Direction.X === direction ? 'clientWidth' : 'clientHeight',\n  } as AttrMapType;\n};\n\nexport function debounce(cb: Function, delay = 100) {\n  let timer: NodeJS.Timeout;\n  return function(...args: any) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-ignore\n    // @ts-ignore\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const _this = this;\n    if (timer) clearTimeout(timer);\n    timer = setTimeout(() => {\n      cb.apply(_this, args);\n    }, delay);\n  };\n}\n\n// judge body or documentElement\nexport const isWindowScrollParent = (elm: HTMLElement) => {\n  return !elm.parentElement || !elm.parentElement.parentElement;\n};\n","import React, { useState } from 'react';\nimport { useEffect } from 'react';\nimport {\n  debounce,\n  getAttrMap,\n  AttrMapType,\n  Direction,\n  DirectionType,\n  isWindowScrollParent,\n} from './utils';\n\nexport type UseSmoothScrollType = {\n  /** the container dom RefObject which use `overflow:scroll`, if scroll whole document, pass `ref = useRef(document.documentElement)` or `useRef(document.body)`. */\n  ref: React.RefObject<HTMLElement>;\n  /** distance per frame, reflects to speed while scrolling */\n  speed?: number;\n  /** scroll direction, you can use 'x` for vertical, 'y` for horizontal */\n  direction?: DirectionType;\n  /** allowable distance beteween nowable state the judgement edge */\n  threshold?: number;\n};\n\n// get the relative distance from destination\nexport const getRelativeDistance = (\n  target: number | string | undefined,\n  parent: HTMLElement,\n  attrMap: AttrMapType\n) => {\n  if (typeof target === 'number') return target;\n  if (typeof target === 'string') {\n    const elm = document.querySelector(target);\n    if (!elm) {\n      console.warn('Please pass correct selector string for scrollTo()!');\n      return 0;\n    }\n    let dis = 0;\n\n    // if parent is document.documentElement or document.body\n    if (isWindowScrollParent(parent)) {\n      dis = elm.getBoundingClientRect()[attrMap.leftTop];\n    } else {\n      dis =\n        elm.getBoundingClientRect()[attrMap.leftTop] -\n        parent.getBoundingClientRect()[attrMap.leftTop];\n    }\n\n    return dis;\n  }\n  return 0;\n};\n\nexport const useSmoothScroll = ({\n  ref,\n  speed = 100,\n  direction = Direction.Y,\n  threshold = 1,\n}: UseSmoothScrollType) => {\n  const attrMap = getAttrMap(direction);\n\n  const [reachedTop, setReachedTop] = useState(true);\n  const [reachedBottom, setReachedBottom] = useState(true);\n  const [size, setSize] = useState(0);\n\n  const isTopEdge = () => {\n    const elm = ref.current;\n    if (!elm) return false;\n    return elm[attrMap.scrollLeftTop] === 0;\n  };\n\n  const isBottomEdge = () => {\n    const elm = ref.current;\n    if (!elm) return false;\n    return (\n      Math.abs(\n        elm[attrMap.scrollLeftTop] +\n          elm[attrMap.clientWidthHeight] -\n          elm[attrMap.scrollWidthHeight]\n      ) < threshold\n    );\n  };\n\n  const refreshSize = debounce(() => {\n    if (ref.current) {\n      const size = ref.current[attrMap.clientWidthHeight];\n      setSize(size);\n    }\n  });\n\n  const refreshState = debounce((_evt: Event) => {\n    isTopEdge() ? setReachedTop(true) : setReachedTop(false);\n    isBottomEdge() ? setReachedBottom(true) : setReachedBottom(false);\n  });\n\n  const scrollTo = (target?: number | string, offset?: number) => {\n    if (!ref || !ref.current) {\n      console.warn(\n        'Please pass `ref` property for your scroll container! \\n Get more info at https://github.com/ron0115/react-smooth-scroll-hook'\n      );\n      return;\n    }\n    const elm = ref.current;\n    if (!elm) return;\n    if (!target && typeof target !== 'number') {\n      console.warn(\n        'Please pass a valid property for `scrollTo()`! \\n Get more info at https://github.com/ron0115/react-smooth-scroll-hook'\n      );\n    }\n\n    const initScrollLeftTop = elm[attrMap.scrollLeftTop];\n\n    let distance = getRelativeDistance(target, elm, attrMap);\n\n    // set a offset\n    if (typeof offset === 'number') {\n      distance += offset;\n    }\n\n    let _speed = speed;\n    const cb = () => {\n      refreshState();\n\n      if (distance === 0) return;\n\n      if ((isBottomEdge() && distance > 9) || (distance < 0 && isTopEdge()))\n        return;\n\n      const gone = () =>\n        Math.abs(elm[attrMap.scrollLeftTop] - initScrollLeftTop);\n\n      if (Math.abs(distance) - gone() < _speed) {\n        _speed = Math.abs(distance) - gone();\n      }\n\n      // distance to run every frameï¼Œalways 1/60s\n      elm[attrMap.scrollLeftTop] += _speed * (distance > 0 ? 1 : -1);\n\n      // reach destination, threshold defaults to 1\n      if (Math.abs(gone() - Math.abs(distance)) < threshold) {\n        return;\n      }\n\n      requestAnimationFrame(cb);\n    };\n    requestAnimationFrame(cb);\n  };\n\n  // detect dom changes\n  useEffect(() => {\n    if (!ref.current) return;\n\n    refreshState();\n    refreshSize();\n    const observer = new MutationObserver((mutationsList, _observer) => {\n      // Use traditional 'for loops' for IE 11\n      for (const mutation of mutationsList) {\n        if (\n          mutation.type === 'attributes' &&\n          mutation.target instanceof Element\n        ) {\n          refreshSize();\n        }\n      }\n    });\n    observer.observe(ref.current, {\n      attributes: true,\n    });\n    window.addEventListener('resize', refreshSize);\n    return () => {\n      observer.disconnect();\n      window.removeEventListener('resize', refreshSize);\n    };\n  }, [ref, refreshState, refreshSize]);\n\n  // detect scrollbar changes\n  useEffect(() => {\n    if (!ref.current) return;\n    const elm = ref.current;\n    const observer = new MutationObserver((mutationsList, _observer) => {\n      // Use traditional 'for loops' for IE 11\n      for (const mutation of mutationsList) {\n        if (\n          mutation.type === 'childList' &&\n          mutation.target instanceof Element\n        ) {\n          refreshState();\n        }\n      }\n    });\n    observer.observe(elm, {\n      childList: true,\n      subtree: true,\n    });\n    elm.addEventListener('scroll', refreshState);\n    return () => {\n      observer.disconnect();\n      elm && elm.removeEventListener('scroll', refreshState);\n    };\n  }, [ref, refreshState]);\n\n  return {\n    reachedTop,\n    reachedBottom,\n    containerSize: size,\n    scrollTo,\n    /** @deprecated replace with scrollTo(n * containerSize) */\n    scrollToPage: (page: number) => {\n      scrollTo(page * size);\n    },\n    /** @deprecated */\n    refreshState,\n    /** @deprecated */\n    refreshSize,\n  };\n};\nexport default useSmoothScroll;\n","import { useEffect, useState } from 'react';\nimport {\n  debounce,\n  DirectionType,\n  getAttrMap,\n  isWindowScrollParent,\n} from './utils';\n\nexport type useScrollWathType = {\n  /** the container dom RefObject which use `overflow:scroll`,if scroll whole document, pass `ref = useRef(document.documentElement)` or `useRef(document.body)`. */\n  ref: React.RefObject<HTMLElement>;\n  list: {\n    /** dom id of Element */\n    href: string;\n    /** the scroll position judge preset of each Element */\n    offset?: number;\n  }[];\n  /** global offset for every Element of list */\n  offset?: number;\n  /** scroll axis, x for horizontal, y for vertical */\n  direction?: DirectionType;\n};\n\nexport const getCurIndex = (scrollTop: number, list: number[]) => {\n  const length = list.length;\n  if (!length) return -1;\n\n  for (let i = 0; i < length; i++) {\n    if (scrollTop < list[i]) {\n      return i - 1;\n    }\n  }\n\n  if (scrollTop >= list[length - 1]) {\n    return list.length - 1;\n  }\n\n  return -1;\n};\n\nexport const useScrollWatch = (props: useScrollWathType) => {\n  const { ref, list = [], offset, direction = 'y' } = props;\n\n  const attrMap = getAttrMap(direction);\n\n  const getScrollTop = () => {\n    const elm = ref.current;\n    if (!elm) return 0;\n    return elm[attrMap.scrollLeftTop];\n  };\n\n  const [scrollTop, setScrollTop] = useState(getScrollTop() || 0);\n\n  const getPosList = () => {\n    let posList = list.map(item => {\n      const parent = ref.current;\n      const os = typeof item.offset === 'number' ? item.offset : offset || 0;\n      const elm = document.querySelector(item.href);\n      if (!elm) return Infinity;\n      if (!parent) return Infinity;\n      return isWindowScrollParent(parent)\n        ? elm.getBoundingClientRect()[attrMap.leftTop] -\n            parent.getBoundingClientRect()[attrMap.leftTop] +\n            os\n        : elm.getBoundingClientRect()[attrMap.leftTop] -\n            parent.children[0].getBoundingClientRect()[attrMap.leftTop] +\n            os;\n    });\n    return posList;\n  };\n\n  const refresh = debounce(() => {\n    setScrollTop(getScrollTop());\n    setPosList(getPosList());\n  }, 100);\n\n  const [posList, setPosList] = useState<number[]>([]);\n\n  useEffect(() => {\n    refresh();\n  }, [ref, refresh]);\n\n  const curIndex = getCurIndex(scrollTop, posList);\n\n  useEffect(() => {\n    if (!ref.current) return;\n    const elm = isWindowScrollParent(ref.current) ? window : ref.current;\n    const observer = new window.MutationObserver(refresh);\n    observer.observe(ref.current, {\n      childList: true,\n      subtree: true,\n    });\n    elm.addEventListener('scroll', refresh);\n    return () => {\n      observer.disconnect();\n      elm && elm.removeEventListener('scroll', refresh);\n    };\n  }, [ref, refresh]);\n\n  return {\n    curIndex,\n    scrollTop,\n    curItem: list[curIndex] || {},\n  };\n};\n"],"names":["Direction","getAttrMap","direction","leftTop","X","offsetLeftTop","offsetWidthHeight","scrollLeftTop","scrollWidthHeight","clientWidthHeight","debounce","cb","delay","timer","args","_this","clearTimeout","setTimeout","apply","isWindowScrollParent","elm","parentElement","getRelativeDistance","target","parent","attrMap","document","querySelector","console","warn","dis","getBoundingClientRect","useSmoothScroll","ref","speed","Y","threshold","useState","reachedTop","setReachedTop","reachedBottom","setReachedBottom","size","setSize","isTopEdge","current","isBottomEdge","Math","abs","refreshSize","refreshState","_evt","scrollTo","offset","initScrollLeftTop","distance","_speed","gone","requestAnimationFrame","useEffect","observer","MutationObserver","mutationsList","_observer","mutation","type","Element","observe","attributes","window","addEventListener","disconnect","removeEventListener","childList","subtree","containerSize","scrollToPage","page","getCurIndex","scrollTop","list","length","i","useScrollWatch","props","getScrollTop","setScrollTop","getPosList","posList","map","item","os","href","Infinity","children","refresh","setPosList","curIndex","curItem"],"mappings":"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"}